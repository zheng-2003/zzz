
<!DOCTYPE html>
<html lang="en">
    <!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  
    <link rel="icon" href="/img/favicon.png">
  
  
      <meta name="author" content="é˜¿æ­£">
  
  
  
  
  
    <link rel="alternate" href="/atom.xml " title="æ¬¢è¿æ¥åˆ°é˜¿æ­£çš„åšå®¢" type="application/atom+xml">
  

  

  <title>æ¬¢è¿æ¥åˆ°é˜¿æ­£çš„åšå®¢</title>

  

  

  

  <link rel="stylesheet" href="/css/style.css" >
  <link rel="stylesheet" href="/css/partial/dark.css" >

  
    <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;500;700&amp;display=swap"  media="print" onload="this.media='all'">
  
  
  

  
    
      <link rel="stylesheet" href="/css/partial/highlight/atom-one-light.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css">
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/css/iconfont.css">
    
  

  
    <script src="/js/todark.js"></script>
    
<meta name="generator" content="Hexo 5.4.0"></head>
</html>
    
<div class="nav index" style="height: 60px;">
    <div class="title animated fadeInDown">
        <div class="layui-container">
                <div class="nav-title"><a href="/" title="æ¬¢è¿æ¥åˆ°é˜¿æ­£çš„åšå®¢">æ¬¢è¿æ¥åˆ°é˜¿æ­£çš„åšå®¢</a></div>
            <div class="nav-list">
                <button> <span class=""></span><span style="display: block;"></span><span class=""></span> </button>
                <ul class="layui-nav" lay-filter="">
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/blong/data/links.yml/">
                            <i class="" style="color:;"></i>
                            <span class="layui-nav-item-name">Search</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/ ">
                            <i class=" fab fa-fort-awesome " style="color: rgb(255 107 107);"></i>
                            <span class="layui-nav-item-name">Home</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/blong/archives/">
                            <i class="" style="color:;"></i>
                            <span class="layui-nav-item-name">Archives</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/blong/tags/">
                            <i class="" style="color:;"></i>
                            <span class="layui-nav-item-name">Tags</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/blong/categories/">
                            <i class="" style="color:;"></i>
                            <span class="layui-nav-item-name">Categories</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/blong/about/">
                            <i class="" style="color:;"></i>
                            <span class="layui-nav-item-name">About</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/guestbook/ ">
                            <i class=" fab fa-telegram " style="color: hsl(205deg 100% 50%);"></i>
                            <span class="layui-nav-item-name">Guestbook</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/blong/link/">
                            <i class="" style="color:;"></i>
                            <span class="layui-nav-item-name">Friends</span>
                        </a>
                    </li>
                    
                        
                        
                        
                        
                    <li class="layui-nav-item">
                        <a href="/shuoshuo/ ">
                            <i class=" fas fa-coffee " style="color:#31c7c1;"></i>
                            <span class="layui-nav-item-name">è¯´è¯´</span>
                        </a>
                    </li>
                    
                    
                        <li class="layui-nav-item" id="btn-toggle-dark">ğŸŒ™</li>
                    
                    <span class="layui-nav-bar" style="left: 342px; top: 78px; width: 0px; opacity: 0;"></span>
                </ul>
            </div>
        </div>
    </div>
</div>
    
<header class="header">
        
            <div class="logo">
                    <a href="/"><img src="/img/hhj.png/" onerror=this.onerror=null,this.src="/img/hhj.png"></a>
            </div>
         
    </div>
     
    
            <div class="social">
                
                        <a class="social-icon" href="https://github.com/a2396837" target="_blank" title="Github">
                            <i class="iconfont icon-GitHub" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="mailto:894049579@qq.com" target="_blank" title="Email">
                            <i class="iconfont icon-email" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="https://steamcommunity.com/id/a2396837" target="_blank" title="Steam">
                            <i class="iconfont icon-steam" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="https://space.bilibili.com/8823569" target="_blank" title="Bilibili">
                            <i class="iconfont icon-bilibili" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="https://music.163.com/#/user/home?id=262078590" target="_blank" title="Netmusic">
                            <i class="iconfont icon-wangyiyunyinle1" aria-hidden="true"></i>
                          </a>
                 
                        <a class="social-icon" href="/atom.xml" target="_blank" title="rss">
                            <i class="iconfont icon-rss" aria-hidden="true"></i>
                          </a>
                 
            </div>
     
</header>

    

  <div id="recent-posts">
    
      <div class="recent-post-item">
          <div class="post-title ">
            <a href="/%E7%9B%B4%E6%92%ADflv/">æµè§ˆå™¨ä¸­å®ç°ç›´æ’­</a>
          </div>
          <div class="post-meta">
            
            
              <div class="post-meta-item date">
                <span title="Created 2020.08.30"><i class="far fa-calendar-alt"></i> 2020.08.30</span>
              </div>
              <div class="post-meta-item updated">
                <span title="Updated 2021.04.02"><i class="far fa-calendar-check"></i> 2021.04.02</span>
              </div>
             
             
            
             <div class="post-meta-item wordcount">
                
                  <i class="fas fa-pencil-alt"></i> <span class="post-count">865 words</span>
                   
                
                  <i class="far fa-clock"></i> <span class="post-count">3 min</span>
                                       
              </div>
             
        </div>
          <div class="content">
            
                  <h1 id="è§†é¢‘ç›´æ’­"><a href="#è§†é¢‘ç›´æ’­" class="headerlink" title="è§†é¢‘ç›´æ’­"></a>è§†é¢‘ç›´æ’­</h1><h3 id="ä¸€ï¼Œæ¦‚å¿µéƒ¨åˆ†"><a href="#ä¸€ï¼Œæ¦‚å¿µéƒ¨åˆ†" class="headerlink" title="ä¸€ï¼Œæ¦‚å¿µéƒ¨åˆ†"></a>ä¸€ï¼Œæ¦‚å¿µéƒ¨åˆ†</h3><h3 id="è§†é¢‘ç›´æ’­åˆ†ä¸ºå‡ éƒ¨åˆ†"><a href="#è§†é¢‘ç›´æ’­åˆ†ä¸ºå‡ éƒ¨åˆ†" class="headerlink" title="è§†é¢‘ç›´æ’­åˆ†ä¸ºå‡ éƒ¨åˆ†"></a>è§†é¢‘ç›´æ’­åˆ†ä¸ºå‡ éƒ¨åˆ†</h3><ul>
<li><p>æ¨æµï¼š</p>
<ul>
<li>å°±æ˜¯å°†ä½ ç°åœ¨ç›´æ’­çš„å†…å®¹åˆ†æˆå¥½å‡ æ®µä¸€æ®µä¸€æ®µçš„æ‰“åŒ…å¥½ï¼Œæ ¼å¼æ˜¯.flv<br>è¿™ä¸ªflvæ ¼å¼çš„æ¯”è¾ƒç®€å•è½»é‡ï¼ŒåŠ è½½é€Ÿåº¦å¿«ï¼Œæ’­æ”¾ä¹Ÿå¿«<br>è¿™é‡Œæˆ‘ä½¿ç”¨çš„è½¯ä»¶æ˜¯OBSï¼Œä¸‹è½½åœ°å€æ˜¯ï¼š<a target="_blank" rel="noopener" href="https://obsproject.com/zh-cn">https://obsproject.com/zh-cn</a>   </li>
</ul>
</li>
<li><p>æ‹‰æµï¼š</p>
<ul>
<li>å°±æ˜¯æ‹‰å–æ‰“åŒ…å¥½çš„è§†é¢‘å°†å®ƒæ‹¼æ¥èµ·æ¥æ’­æ”¾ç»™ç”¨æˆ·ï¼Œè¿™é‡Œæˆ‘ç”¨çš„æ˜¯Vlcï¼Œä¸‹è½½åœ°å€æ˜¯ <a target="_blank" rel="noopener" href="https://www.videolan.org/vlc/">https://www.videolan.org/vlc/</a><br>è¿™é‡Œå‘¢ï¼Œæˆ‘æ˜¯ç”¨çš„HTTP-FLVç›´æ’­åè®®<h3 id="HTTP-FLVçš„ä¼˜ç¼ºç‚¹"><a href="#HTTP-FLVçš„ä¼˜ç¼ºç‚¹" class="headerlink" title="HTTP-FLVçš„ä¼˜ç¼ºç‚¹"></a>HTTP-FLVçš„ä¼˜ç¼ºç‚¹</h3></li>
</ul>
</li>
<li><p>ä¼˜ç‚¹: </p>
<ul>
<li>å¯ä»¥ç›´æ¥é€šè¿‡httpåè®®è¿›è¡Œä¼ è¾“ï¼Œhttpå±äºå…¬å…±åè®®ï¼Œå…¬å…±ç«¯å£ï¼š80<br>htmlæ’­æ”¾è§†é¢‘å°±å¾ˆç®€å•ï¼Œ video<br>æ”¯æŒåŠ å¯†ï¼Œä½¿ç”¨https<br>å…¼å®¹ç§»åŠ¨ç«¯è®¾å¤‡ï¼Œæ¯”å¦‚ï¼šå®‰å“ã€ios</li>
</ul>
</li>
<li><p>ç¼ºç‚¹: </p>
<ul>
<li>ä¼šç¼“å­˜ç›´æ’­æ•°æ®ï¼Œä¿å­˜ç›´æ’­ä¼ è¾“è¿‡æ¥çš„ä¸€æ®µæ®µflvæ–‡ä»¶ï¼Œéšç§ä¿å¯†ä¸å¥½<br>ä¸èƒ½åœ¨å¤§å¹¶å‘æƒ…å†µä¸‹ä½¿ç”¨<br>äºŒï¼Œåº”ç”¨åœºæ™¯<br>å…¶å®è¿™ä¸ªè§†é¢‘ç›´æ’­åœ¨å¾ˆå¤šå¤§å¹³å°è™ç‰™ï¼Œæ–—é±¼ï¼ŒæŠ–éŸ³ï¼Œå¿«æ‰‹ç­‰ç­‰ï¼Œéƒ½æ˜¯æœ‰è¿™ä¸ªåŠŸèƒ½çš„ã€‚æ¯”å¦‚ä½ çš„é¡¹ç›®éœ€è¦ç”¨åˆ°ç›´æ’­ï¼ŒçœŸäººè®²è§£å°±å¯ä»¥åº”ç”¨è¿™ä¸ªã€‚</li>
</ul>
</li>
</ul>
<p>ä¸‰ï¼Œä»£ç å®ç°</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir /usr/local/nginx-flv</span><br><span class="line"># åˆ›å»ºäº†ä¸€ä¸ªå®‰è£…ç›®å½•</span><br><span class="line">mkdir /home/flv-tools</span><br><span class="line"># å­˜å‚¨æ‰€éœ€è½¯ä»¶</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½è¿™ä¸ªæ–‡ä»¶</span></span><br><span class="line">wget https://nginx.org/download/nginx-<span class="number">1.18</span><span class="number">.0</span>.tar.gz</span><br><span class="line">git clone https://github.com/winshining/nginx-http-flv-module</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è§£å‹è¿™ä¸¤ä¸ªæ–‡ä»¶</span></span><br><span class="line">tar -zxvf nginx-<span class="number">1.18</span><span class="number">.0</span>.tar.gz nginx-<span class="number">1.18</span><span class="number">.0</span></span><br><span class="line">unzip nginx-http-flv-module.<span class="built_in">zip</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®æ–‡ä»¶</span></span><br><span class="line">cd nginx-<span class="number">1.18</span><span class="number">.0</span></span><br><span class="line">./configure --prefix=/usr/local/nginx-flv --add-module=/home/flv-tools/nginx-http-flv-module-master</span><br><span class="line"><span class="comment"># --prefix: é…ç½®å®‰è£…è·¯å¾„</span></span><br><span class="line"><span class="comment">#--add-module: æ·»åŠ å®‰è£…æ’ä»¶</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ç¼–è¯‘åŠå®‰è£…</span></span><br><span class="line">make </span><br><span class="line">make install </span><br><span class="line">make &amp;&amp; make install </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¯¹é…ç½®æ–‡ä»¶è¿›è¡Œä¿®æ”¹</span></span><br><span class="line">worker_processes  <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">rtmp_auto_push on;</span><br><span class="line">rtmp_auto_push_reconnect 1s;</span><br><span class="line">rtmp_socket_dir /tmp;</span><br><span class="line"></span><br><span class="line">rtmp&#123;</span><br><span class="line">	out_queue <span class="number">4096</span>;</span><br><span class="line">	out_cork <span class="number">8</span>;</span><br><span class="line">	max_streams <span class="number">128</span>;</span><br><span class="line">	timeout 15s;</span><br><span class="line">	drop_idle_publisher 15s;</span><br><span class="line">	log_interval 5s;</span><br><span class="line">	log_size 1m;</span><br><span class="line">	server &#123;</span><br><span class="line">		listen <span class="number">1935</span>; <span class="comment"># æ¨æµç«¯å£</span></span><br><span class="line">		server_name zege;</span><br><span class="line">		</span><br><span class="line">		application live &#123;	<span class="comment"># é…ç½®æ¨æµåœ°å€</span></span><br><span class="line">			live on; <span class="comment"># æ‰“å¼€æ¨æµ</span></span><br><span class="line">			<span class="comment"># gop_cache on;</span></span><br><span class="line">			<span class="comment"># rtmp://123.123.123.123:1935/live/test</span></span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">events &#123;</span><br><span class="line">    worker_connections  <span class="number">1024</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½®æ–‡ä»¶httpæ‹‰æµéƒ¨åˆ†</span></span><br><span class="line">http &#123;</span><br><span class="line">	include       mime.types;</span><br><span class="line">	default_type  application/octet-stream;</span><br><span class="line">	sendfile        on;</span><br><span class="line">	keepalive_timeout  <span class="number">65</span>;</span><br><span class="line">	server &#123;</span><br><span class="line">		listen       <span class="number">8080</span>; <span class="comment"># æ‹‰æµé€šè¿‡8080å»æ‹‰æµ</span></span><br><span class="line">		<span class="comment"># http://123.123.123.123:8080/live/?port=1935&amp;stream=test</span></span><br><span class="line">		server_name  localhost;</span><br><span class="line">		location /live &#123;</span><br><span class="line">			flv_live on;</span><br><span class="line">			chunked_transfer_encoding  on;</span><br><span class="line">			add_header <span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span> <span class="string">&#x27;*&#x27;</span>;</span><br><span class="line">			add_header <span class="string">&#x27;Access-Control-Allow-Credentials&#x27;</span> <span class="string">&#x27;true&#x27;</span>;</span><br><span class="line">		&#125;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="å¿…é¡»ç¡®ä¿æœåŠ¡å¼€å¯ï¼Œè¿˜æœ‰é˜¿é‡Œäº‘çš„é˜²ç«å¢™ï¼Œè¿™ä¸ªå¾ˆé‡è¦"><a href="#å¿…é¡»ç¡®ä¿æœåŠ¡å¼€å¯ï¼Œè¿˜æœ‰é˜¿é‡Œäº‘çš„é˜²ç«å¢™ï¼Œè¿™ä¸ªå¾ˆé‡è¦" class="headerlink" title="å¿…é¡»ç¡®ä¿æœåŠ¡å¼€å¯ï¼Œè¿˜æœ‰é˜¿é‡Œäº‘çš„é˜²ç«å¢™ï¼Œè¿™ä¸ªå¾ˆé‡è¦"></a>å¿…é¡»ç¡®ä¿æœåŠ¡å¼€å¯ï¼Œè¿˜æœ‰é˜¿é‡Œäº‘çš„é˜²ç«å¢™ï¼Œè¿™ä¸ªå¾ˆé‡è¦</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å…³é—­æœåŠ¡</span></span><br><span class="line">/usr/local/nginx-rtmp/sbin/nginx -s stop</span><br><span class="line"><span class="comment"># é‡å¯æœåŠ¡</span></span><br><span class="line">/usr/local/nginx-rtmp/sbin/nginx -s reload</span><br><span class="line"><span class="comment"># æ‰“å¼€æœåŠ¡</span></span><br><span class="line">/usr/local/nginx-flv/sbin/nginx -c /usr/local/nginx-flv/conf/nginx.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨è½¯ä»¶ä¸­è®¾ç½®æ¨æµåœ°å€å’Œæ‹‰æµåœ°å€</span></span><br><span class="line">rtmp://ï¼ˆè‡ªå·±çš„äº‘ä¸»æœºç«¯å£ï¼‰:<span class="number">1935</span>/live/test</span><br><span class="line"></span><br><span class="line">http://(è‡ªå·±äº‘ä¸»æœºç«¯å£):8080/live?port=1935&amp;app=live&amp;stream=test</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// æœ€ååœ¨vueä¸­å®ç°æ‹‰æµ</span></span><br><span class="line"><span class="comment">// ä¸‹è½½ä¾èµ–</span></span><br><span class="line">cnpm install flv.js --save</span><br><span class="line"><span class="comment">// åœ¨éœ€è¦çš„é¡µé¢å¯¼åŒ…</span></span><br><span class="line"><span class="keyword">import</span> flv <span class="keyword">from</span> <span class="string">&#x27;flv.js&#x27;</span>;</span><br><span class="line"><span class="comment">// æ„å»ºæ’­æ”¾æ ‡ç­¾</span></span><br><span class="line">&lt;video id=<span class="string">&quot;videoElement&quot;</span> controls muted&gt;</span><br><span class="line">  	</span><br><span class="line">&lt;/video&gt;</span><br><span class="line"><span class="comment">// è¿›è¡Œåˆå§‹åŒ–</span></span><br><span class="line">  <span class="function"><span class="title">mounted</span>(<span class="params"></span>)</span> &#123;</span><br><span class="line">    <span class="keyword">var</span> videoElement = <span class="built_in">document</span>.getElementById(<span class="string">&#x27;videoElement&#x27;</span>);</span><br><span class="line">    <span class="keyword">var</span> flvPlayer = flv.createPlayer(&#123;</span><br><span class="line">      type: <span class="string">&#x27;flv&#x27;</span>,</span><br><span class="line">      enableWorker: <span class="literal">true</span>,     <span class="comment">//æµè§ˆå™¨ç«¯å¼€å¯flv.jsçš„worker,å¤šè¿›ç¨‹è¿è¡Œflv.js</span></span><br><span class="line">      isLive: <span class="literal">true</span>,           <span class="comment">//ç›´æ’­æ¨¡å¼</span></span><br><span class="line">      hasAudio: <span class="literal">false</span>,        <span class="comment">//å…³é—­éŸ³é¢‘</span></span><br><span class="line">      hasVideo: <span class="literal">true</span>,</span><br><span class="line">      <span class="comment">// cors: true,</span></span><br><span class="line">      stashInitialSize: <span class="number">128</span>,</span><br><span class="line">      enableStashBuffer: <span class="literal">false</span>, <span class="comment">//æ’­æ”¾flvæ—¶ï¼Œè®¾ç½®æ˜¯å¦å¯ç”¨æ’­æ”¾ç¼“å­˜ï¼Œåªåœ¨ç›´æ’­èµ·ä½œç”¨ã€‚</span></span><br><span class="line">      url: <span class="string">&#x27;http://ï¼ˆè‡ªå·±äº‘ä¸»æœºç«¯å£ï¼‰/live?port=1935&amp;app=live&amp;stream=test&#x27;</span></span><br><span class="line">    &#125;)</span><br><span class="line">    flvPlayer.attachMediaElement(videoElement);</span><br><span class="line">    flvPlayer.load();</span><br><span class="line">    flvPlayer.play();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
             
          </div>
        </div>
      <div class="post-footer">
        
    </div>
    
      <div class="recent-post-item">
          <div class="post-title ">
            <a href="/%E6%B5%8B%E8%AF%95%E5%88%86%E7%B1%BB/">æµ‹è¯•åˆ†ç±»</a>
          </div>
          <div class="post-meta">
            
            
              <div class="post-meta-item date">
                <span title="Created 2020.08.25"><i class="far fa-calendar-alt"></i> 2020.08.25</span>
              </div>
              <div class="post-meta-item updated">
                <span title="Updated 2021.03.17"><i class="far fa-calendar-check"></i> 2021.03.17</span>
              </div>
             
            
              <div class="post-meta-item categories">
                
                  <i class="fas fa-inbox article-meta__icon"></i> <a href="/categories/Hexo/">Hexo</a>
                
              </div>
             
            
             <div class="post-meta-item wordcount">
                
                  <i class="fas fa-pencil-alt"></i> <span class="post-count">7 words</span>
                   
                
                  <i class="far fa-clock"></i> <span class="post-count">1 min</span>
                                       
              </div>
             
        </div>
          <div class="content">
            
                  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">è¿™æ˜¯ä¸€ä¸ªæµ‹è¯•</span><br></pre></td></tr></table></figure>

             
          </div>
        </div>
      <div class="post-footer">
        
    </div>
    
      <div class="recent-post-item">
          <div class="post-title ">
            <a href="/%E6%94%AF%E4%BB%98%E5%AE%9D%E4%B8%89%E6%96%B9%E6%94%AF%E4%BB%98%E6%B5%81%E7%A8%8B/">æ”¯ä»˜å®ä¸‰æ–¹æ”¯ä»˜æµç¨‹</a>
          </div>
          <div class="post-meta">
            
            
              <div class="post-meta-item date">
                <span title="Created 2020.07.02"><i class="far fa-calendar-alt"></i> 2020.07.02</span>
              </div>
              <div class="post-meta-item updated">
                <span title="Updated 2021.04.02"><i class="far fa-calendar-check"></i> 2021.04.02</span>
              </div>
             
             
            
             <div class="post-meta-item wordcount">
                
                  <i class="fas fa-pencil-alt"></i> <span class="post-count">516 words</span>
                   
                
                  <i class="far fa-clock"></i> <span class="post-count">2 min</span>
                                       
              </div>
             
        </div>
          <div class="content">
            
                  <h1 id="æ”¯ä»˜å®ä¸‰æ–¹æ”¯ä»˜"><a href="#æ”¯ä»˜å®ä¸‰æ–¹æ”¯ä»˜" class="headerlink" title="æ”¯ä»˜å®ä¸‰æ–¹æ”¯ä»˜"></a>æ”¯ä»˜å®ä¸‰æ–¹æ”¯ä»˜</h1><h3 id="ä¸€-ä¸‹è½½ä¸€ä¸ªæ”¯ä»˜å®å¼€æ”¾å¹³å°å¼€å‘åŠ©æ‰‹ç”Ÿæˆç§˜é’¥"><a href="#ä¸€-ä¸‹è½½ä¸€ä¸ªæ”¯ä»˜å®å¼€æ”¾å¹³å°å¼€å‘åŠ©æ‰‹ç”Ÿæˆç§˜é’¥" class="headerlink" title="ä¸€,ä¸‹è½½ä¸€ä¸ªæ”¯ä»˜å®å¼€æ”¾å¹³å°å¼€å‘åŠ©æ‰‹ç”Ÿæˆç§˜é’¥"></a>ä¸€,ä¸‹è½½ä¸€ä¸ªæ”¯ä»˜å®å¼€æ”¾å¹³å°å¼€å‘åŠ©æ‰‹ç”Ÿæˆç§˜é’¥</h3><h3 id="è¿›å…¥-https-www-alipay-com-å¹¶ç™»é™†-ç„¶åæ³¨å†Œä¸€ä¸ªæ²™ç®±"><a href="#è¿›å…¥-https-www-alipay-com-å¹¶ç™»é™†-ç„¶åæ³¨å†Œä¸€ä¸ªæ²™ç®±" class="headerlink" title="è¿›å…¥ https://www.alipay.com/ å¹¶ç™»é™†,ç„¶åæ³¨å†Œä¸€ä¸ªæ²™ç®±"></a>è¿›å…¥ <a target="_blank" rel="noopener" href="https://www.alipay.com/">https://www.alipay.com/</a> å¹¶ç™»é™†,ç„¶åæ³¨å†Œä¸€ä¸ªæ²™ç®±</h3><h3 id="ä¸‹è½½-pip-install-python-alipay-sdk-â€“upgrade-æ¨¡å—"><a href="#ä¸‹è½½-pip-install-python-alipay-sdk-â€“upgrade-æ¨¡å—" class="headerlink" title="ä¸‹è½½ pip install python-alipay-sdk â€“upgrade æ¨¡å—"></a>ä¸‹è½½ pip install python-alipay-sdk â€“upgrade æ¨¡å—</h3><p>æµç¨‹å›¾:<br><img src= "/img/hhj.png" data-src="https://i.loli.net/2021/01/30/QElYTGVxfKyX9P5.png" alt="æ”¯ä»˜å®æ”¯ä»˜æµç¨‹å›¾.png"></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment"># å°†åˆšä¸‹è½½çš„æ¨¡å—ä¸­å¯¼å‡ºéœ€è¦ç”¨çš„åŒ…</span></span><br><span class="line"><span class="keyword">from</span> alipay <span class="keyword">import</span> AliPay</span><br><span class="line"><span class="keyword">from</span> alipay.utils <span class="keyword">import</span> AliPayConfig</span><br><span class="line"></span><br><span class="line"><span class="comment"># å¼€å‘ä¸€ä¸ªæ”¯ä»˜æ¥å£</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AlipayView</span>(<span class="params">APIView</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        sn = request.data.get(<span class="string">&quot;sn&quot;</span>)</span><br><span class="line">        total = request.data.get(<span class="string">&quot;total&quot;</span>)</span><br><span class="line">        <span class="comment"># è·å–ç§˜é’¥ä¿¡æ¯</span></span><br><span class="line">        app_private_key_string = <span class="built_in">open</span>(<span class="string">&quot;buyapp/alipay/app_private_key.txt&quot;</span>).read()</span><br><span class="line">        alipay_public_key_string = <span class="built_in">open</span>(<span class="string">&quot;buyapp/alipay/alipay_public_key.txt&quot;</span>).read()</span><br><span class="line"></span><br><span class="line">        alipay = AliPay(</span><br><span class="line">            appid=<span class="string">&quot;2016101600696807&quot;</span>,</span><br><span class="line">            app_notify_url=<span class="literal">None</span>,  <span class="comment"># é»˜è®¤å›è°ƒurl</span></span><br><span class="line">            app_private_key_string=app_private_key_string,</span><br><span class="line">            <span class="comment"># æ”¯ä»˜å®çš„å…¬é’¥ï¼ŒéªŒè¯æ”¯ä»˜å®å›ä¼ æ¶ˆæ¯ä½¿ç”¨ï¼Œä¸æ˜¯ä½ è‡ªå·±çš„å…¬é’¥,</span></span><br><span class="line">            alipay_public_key_string=alipay_public_key_string,</span><br><span class="line">            sign_type=<span class="string">&quot;RSA2&quot;</span>,  <span class="comment"># RSA æˆ–è€… RSA2</span></span><br><span class="line">            debug=<span class="literal">True</span>,  <span class="comment"># é»˜è®¤False</span></span><br><span class="line">            config=AliPayConfig(timeout=<span class="number">15</span>)  <span class="comment"># å¯é€‰, è¯·æ±‚è¶…æ—¶æ—¶é—´</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¦‚æœä½ æ˜¯ Python 3çš„ç”¨æˆ·ï¼Œä½¿ç”¨é»˜è®¤çš„å­—ç¬¦ä¸²å³å¯</span></span><br><span class="line">        subject = <span class="string">&quot;é˜¿æ­£å•†åŸè®¢å•æ”¯ä»˜&quot;</span></span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç”µè„‘ç½‘ç«™æ”¯ä»˜ï¼Œéœ€è¦è·³è½¬åˆ°https://openapi.alipay.com/gateway.do? + order_string</span></span><br><span class="line">        order_string = alipay.api_alipay_trade_page_pay(</span><br><span class="line">            out_trade_no=sn,  <span class="comment"># è®¢å•å·</span></span><br><span class="line">            total_amount=total,  <span class="comment"># æ€»é‡‘é¢</span></span><br><span class="line">            subject=subject,  <span class="comment"># æ ‡é¢˜</span></span><br><span class="line">            return_url=<span class="string">&quot;http://localhost:8000/api/v1/buy/pay_callback&quot;</span>,</span><br><span class="line">            <span class="comment"># notify_url=&quot;https://example.com/notify&quot;  # å¯é€‰, ä¸å¡«åˆ™ä½¿ç”¨é»˜è®¤notify url</span></span><br><span class="line">        )</span><br><span class="line"></span><br><span class="line">        <span class="comment"># ç”Ÿæˆä¸€ä¸ªæ”¯ä»˜è¶…é“¾æ¥ï¼Œè¿”å›ç»™vueç«¯ï¼Œ ç‚¹å‡»å°±æ¿€æ´»è¿™ä¸ªè¶…é“¾æ¥</span></span><br><span class="line">        url = <span class="string">&quot;https://openapi.alipaydev.com/gateway.do?&quot;</span> + order_string</span><br><span class="line">        <span class="keyword">return</span> Response(&#123;<span class="string">&quot;url&quot;</span>: url&#125;)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®å›è°ƒåœ°å€</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">AliPayBackView</span>(<span class="params">View</span>):</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        user = request.user</span><br><span class="line">        <span class="comment"># è·å–å›è°ƒçš„ä¿¡æ¯</span></span><br><span class="line">        <span class="comment"># è·å– è®¢å•å·</span></span><br><span class="line">        sn = request.GET.get(<span class="string">&quot;out_trade_no&quot;</span>)</span><br><span class="line">        <span class="comment">#  è·å– æ”¯ä»˜å®äº¤æ˜“å·</span></span><br><span class="line">        trade_no = request.GET.get(<span class="string">&quot;trade_no&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;sn:&quot;</span>, sn)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;trade_no:&quot;</span>, trade_no)</span><br><span class="line">        <span class="comment"># æ‰¾åˆ°è¿™ä¸ªè®¢å• å¹¶æ›´æ–°çŠ¶æ€</span></span><br><span class="line">        <span class="comment"># ä¿®æ”¹äº†  è®¢å•çŠ¶æ€  å¹¶æ·»åŠ äº† æ”¯ä»˜å®äº¤æ˜“å·</span></span><br><span class="line">        Order.objects.<span class="built_in">filter</span>(sn=sn).update(trade_no=trade_no, status=<span class="number">2</span>)</span><br><span class="line">        <span class="comment">#  åˆ é™¤æˆ‘ä»¬è´­ç‰©è½¦ä¸­çš„ å·²ç»æ”¯ä»˜æˆåŠŸçš„è´­ç‰©ä¿¡æ¯</span></span><br><span class="line">        <span class="built_in">print</span>(user)</span><br><span class="line">        <span class="comment"># æŸ¥è¯¢æ‰€æœ‰çš„é€‰ä¸­ ç„¶ååˆ é™¤</span></span><br><span class="line">        gid_set = r.smembers(<span class="string">&quot;select_%d&quot;</span> % user.<span class="built_in">id</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;gid_set:&quot;</span>, gid_set)</span><br><span class="line">        <span class="keyword">for</span> gid <span class="keyword">in</span> gid_set:</span><br><span class="line">            r.hdel(<span class="string">&quot;cart_%d&quot;</span> % user.<span class="built_in">id</span>, gid)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> redirect(<span class="string">&quot;http://127.0.0.1:8080/#/paysuccess?trade_no=&quot;</span> + trade_no)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h3 id="æœ€åé…ç½®è·¯ç”±å³å¯"><a href="#æœ€åé…ç½®è·¯ç”±å³å¯" class="headerlink" title="æœ€åé…ç½®è·¯ç”±å³å¯"></a>æœ€åé…ç½®è·¯ç”±å³å¯</h3>
             
          </div>
        </div>
      <div class="post-footer">
        
    </div>
    
      <div class="recent-post-item">
          <div class="post-title ">
            <a href="/celery%E5%BC%82%E6%AD%A5/">celeryå¼‚æ­¥æ¡ˆä¾‹</a>
          </div>
          <div class="post-meta">
            
            
              <div class="post-meta-item date">
                <span title="Created 2020.04.30"><i class="far fa-calendar-alt"></i> 2020.04.30</span>
              </div>
              <div class="post-meta-item updated">
                <span title="Updated 2021.04.02"><i class="far fa-calendar-check"></i> 2021.04.02</span>
              </div>
             
             
            
             <div class="post-meta-item wordcount">
                
                  <i class="fas fa-pencil-alt"></i> <span class="post-count">345 words</span>
                   
                
                  <i class="far fa-clock"></i> <span class="post-count">1 min</span>
                                       
              </div>
             
        </div>
          <div class="content">
            
                  <h1 id="celeryå¼‚æ­¥æ¡†æ¶"><a href="#celeryå¼‚æ­¥æ¡†æ¶" class="headerlink" title="celeryå¼‚æ­¥æ¡†æ¶"></a>celeryå¼‚æ­¥æ¡†æ¶</h1><p>ä¸€ï¼Œceleryæ˜¯ä»€ä¹ˆï¼Ÿ</p>
<ul>
<li>celeryæ˜¯ä¸€ä¸ªç®€å•ã€çµæ´»ï¼Œå¯é çš„ï¼Œå¤„ç†å¤§é‡æ¶ˆæ¯çš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚å®ƒä¸“æ³¨äºå®æ—¶å¤„ç†çš„å¼‚æ­¥ä»»åŠ¡é˜Ÿåˆ—ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒä»»åŠ¡è°ƒåº¦,celeryæ˜¯Pythonå®ç°çš„åˆ†å¸ƒå¼é˜Ÿåˆ—</li>
<li><a target="_blank" rel="noopener" href="http://docs.jinkan.org/docs/celery/">http://docs.jinkan.org/docs/celery/</a> ä¸­æ–‡ç‰ˆå®˜æ–¹æ–‡æ¡£</li>
</ul>
<p>äºŒï¼Œceleryçš„ç‰¹ç‚¹åŠåº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>å¼€æºï¼Œé€Ÿåº¦å¿«ï¼Œé«˜å¯ç”¨ï¼Œçµæ´»</li>
<li>åº”ç”¨åœºæ™¯å°±æ˜¯æˆ‘ä»¬å¯¹äºä»£ç ä¸­è€—æ—¶é•¿çš„åŠŸèƒ½ï¼Œå¯ä»¥å¼‚æ­¥æ“ä½œï¼Œä¸å½±å“æˆ‘ä»¬å¯¹å®¢æˆ·ç«¯çš„å“åº”</li>
</ul>
<p>ä¸‰ï¼Œä»£ç å®ç°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å®‰è£…ä¸‰ä¸ªåŒ…</span></span><br><span class="line"> pip install -U Celery</span><br><span class="line"> pip install redis</span><br><span class="line"> pip install eventlet</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åˆ›å»ºä¸€ä¸ªtasksæ–‡ä»¶åœ¨è¿™é‡Œé¢å®šä¹‰åˆå§‹åŒ–ä»»åŠ¡</span></span><br><span class="line"><span class="keyword">from</span> celery <span class="keyword">import</span> Celery</span><br><span class="line">app = Celery(<span class="string">&quot;taks&quot;</span>, broker=<span class="string">&quot;redis://localhost/1&quot;</span>)</span><br><span class="line"><span class="meta">@app.task()</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sendSMS</span>(<span class="params">phone, code</span>):</span></span><br><span class="line">    <span class="comment"># å®šä¹‰ä½ è‡ªå·±çš„ä»»åŠ¡</span></span><br><span class="line">     <span class="keyword">return</span> a + b </span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è¿è¡Œcelery worker æœåŠ¡å™¨(çœ‹ä½ è‡ªå·±çš„app)</span></span><br><span class="line"> celery -A userapp.tasks worker --loglevel=INFO</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># åœ¨viewè§†å›¾é‡Œè°ƒç”¨å¼‚æ­¥ä»»åŠ¡</span></span><br><span class="line"><span class="comment">#(ä»¥ä½ è‡ªå·±å®šä¹‰çš„å‡½æ•°åä¸ºå‡†)</span></span><br><span class="line"> sendSMS.delay()</span><br></pre></td></tr></table></figure>
<h3 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h3><ul>
<li>å®‰è£…ä¾èµ–å®Œä»¥å,å»è‡ªå·±çš„appä¸‹åˆ›å»ºä¸€ä¸ªæ–°çš„æ–‡ä»¶,åœ¨æ–‡ä»¶ä¸­å®šä¹‰ä¸€ä¸ªå‡½æ•°,è¿™ä¸ªå‡½æ•°é‡Œé¢å°†æ˜¯ä½ ç»™ä»–çš„ä»»åŠ¡,ç„¶åé€šè¿‡ celery -A è‡ªå·±appå.tasks worker â€“loglevel=INFO è¿™æ¡å‘½ä»¤æ¥å¯åŠ¨è¿™ä¸ªæœåŠ¡,æœ€ååœ¨ä½ çš„viewè§†å›¾é‡Œå¯¼åŒ…è°ƒç”¨è¿™ä¸ªå‡½æ•°å³å¯</li>
</ul>

             
          </div>
        </div>
      <div class="post-footer">
        
    </div>
    
      <div class="recent-post-item">
          <div class="post-title ">
            <a href="/axios%E7%9A%84%E5%B0%81%E8%A3%85/">axiosçš„å°è£…</a>
          </div>
          <div class="post-meta">
            
            
              <div class="post-meta-item date">
                <span title="Created 2020.03.30"><i class="far fa-calendar-alt"></i> 2020.03.30</span>
              </div>
              <div class="post-meta-item updated">
                <span title="Updated 2021.04.02"><i class="far fa-calendar-check"></i> 2021.04.02</span>
              </div>
             
             
            
             <div class="post-meta-item wordcount">
                
                  <i class="fas fa-pencil-alt"></i> <span class="post-count">591 words</span>
                   
                
                  <i class="far fa-clock"></i> <span class="post-count">2 min</span>
                                       
              </div>
             
        </div>
          <div class="content">
            
                  <h1 id="axioså°è£…"><a href="#axioså°è£…" class="headerlink" title="axioså°è£…"></a>axioså°è£…</h1><p>ä¸€ï¼Œä¸ºä»€ä¹ˆå°è£…axios?</p>
<ul>
<li>åœ¨ä¸€ä¸ªé¡¹ç›®ä¸­,åœ¨ç½‘é¡µå¤šçš„æ—¶å€™æˆ‘ä»¬æ¯ä¸ªé¡µé¢éƒ½å¯¼axiosåŒ…ä¼šæ¯”è¾ƒéº»çƒ¦,æˆ‘ä»¬ç”¨å°è£…æ–¹æ³•å°†å®ƒå°è£…èµ·æ¥,æ¯æ¬¡åœ¨é¡µé¢ä¸­è°ƒç”¨å³å¯,ä¼šæé«˜ä»£ç çš„å¤ç”¨æ›´åŠ æ–¹ä¾¿å¿«æ·ã€‚</li>
<li>ä¸€èˆ¬æˆ‘ä¼šåœ¨é¡¹ç›®çš„srcç›®å½•ä¸­ï¼Œæ–°å»ºä¸€ä¸ªrequestæ–‡ä»¶å¤¹ï¼Œç„¶ååœ¨é‡Œé¢æ–°å»ºä¸€ä¸ªhttp.jså’Œä¸€ä¸ªapi.jsæ–‡ä»¶ã€‚http.jsæ–‡ä»¶ç”¨æ¥å°è£…æˆ‘ä»¬çš„axiosï¼Œapi.jsç”¨æ¥ç»Ÿä¸€ç®¡ç†æˆ‘ä»¬çš„æ¥å£ã€‚</li>
</ul>
<p>äºŒï¼ŒåŠŸèƒ½å®ç°</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸‹è½½axiosåŒ…</span></span><br><span class="line">pip install axios --save</span><br></pre></td></tr></table></figure>

<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// åˆ›å»ºä¸€ä¸ªæ–°æ–‡ä»¶</span></span><br><span class="line"><span class="comment">// é…ç½®axiosåŸºæœ¬çš„å±æ€§</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> axios = <span class="built_in">require</span>(<span class="string">&#x27;axios&#x27;</span>)</span><br><span class="line"></span><br><span class="line">axios.defaults.baseURL = <span class="string">&#x27;http://127.0.0.1:8000&#x27;</span> <span class="comment">// è¯·æ±‚çš„æ¥å£ä¸»åŸŸå</span></span><br><span class="line">axios.defaults.timeout = <span class="number">10000</span> <span class="comment">// è¯·æ±‚è¶…æ—¶çš„è®¾ç½® 10s</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// è¯·æ±‚æ‹¦æˆªå™¨(åœ¨è¯·æ±‚å‰ä¼šè‡ªåŠ¨å»åšçš„æ“ä½œ)ï¼Œå¦‚æœç™»é™†äº†ï¼Œé‚£ä¹ˆè‡ªåŠ¨å¸¦tokenå‘é€</span></span><br><span class="line">axios.interceptors.request.use(<span class="function"><span class="params">config</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">let</span> token = sessionStorage.getItem(<span class="string">&#x27;token&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (token) &#123;</span><br><span class="line">    <span class="comment">//axios.defaults.headers[&#x27;Authorization&#x27;] = token // å¤´éƒ¨è®¾ç½®</span></span><br><span class="line">    config.headers.common[<span class="string">&#x27;Authorization&#x27;</span>] = <span class="string">&quot;JWT &quot;</span> + token <span class="comment">// å¤´éƒ¨è®¾ç½®</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> config;</span><br><span class="line">&#125;, <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="built_in">console</span>.log(error)</span><br><span class="line">  <span class="keyword">return</span> <span class="built_in">Promise</span>.reject(error);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// å“åº”æ‹¦æˆªå™¨(åœ¨å“åº”æ—¶è‡ªåŠ¨ä¼šåšçš„æ“ä½œ)ï¼Œæ¯”å¦‚çŠ¶æ€ç è¿”å›ä¸º401æ—¶ï¼Œè¦è¿›å…¥loginç•Œé¢</span></span><br><span class="line">axios.interceptors.response.use(<span class="function"><span class="params">response</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="comment">// 200</span></span><br><span class="line">  <span class="keyword">return</span> response;</span><br><span class="line">&#125;, <span class="function"><span class="params">error</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">if</span> (error.request.status == <span class="number">401</span>) &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="string">&quot;/&quot;</span></span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> error</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * postæ–¹æ³•ï¼Œå¯¹åº”postè¯·æ±‚(å››ä¸ªè¯·æ±‚æ–¹æ³•)</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;String&#125;</span> </span>url [è¯·æ±‚çš„urlåœ°å€]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>params [è¯·æ±‚æ—¶æºå¸¦çš„å‚æ•°]</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param <span class="type">&#123;Object&#125;</span> </span>headers [è¯·æ±‚æ—¶çš„å¤´éƒ¨]</span></span><br><span class="line"><span class="comment"> **/</span></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">get</span>(<span class="params">url, params, headers</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios.get(url, &#123;params, headers&#125;).then(<span class="function"><span class="params">res</span> =&gt;</span> &#123;</span><br><span class="line">      resolve(res)</span><br><span class="line">    &#125;).catch(<span class="function"><span class="params">err</span> =&gt;</span> &#123;</span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">post</span>(<span class="params">url, params, headers</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios.post(url, params, headers).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      resolve(res)</span><br><span class="line">    &#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// debugger</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">put</span>(<span class="params">url, params, headers</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios.put(url, params, headers).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      resolve(res)</span><br><span class="line">    &#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// debugger</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="function"><span class="keyword">function</span> <span class="title">del</span>(<span class="params">url, params, headers</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="built_in">Promise</span>(<span class="function">(<span class="params">resolve, reject</span>) =&gt;</span> &#123;</span><br><span class="line">    axios.delete(url, &#123;<span class="attr">data</span>: params, headers&#125;).then(<span class="function">(<span class="params">res</span>) =&gt;</span> &#123;</span><br><span class="line">      resolve(res)</span><br><span class="line">    &#125;).catch(<span class="function">(<span class="params">err</span>) =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// debugger</span></span><br><span class="line">      reject(err)</span><br><span class="line">    &#125;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> axios;</span><br><span class="line"></span><br></pre></td></tr></table></figure>


<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> &#123;get, post, put, del&#125; <span class="keyword">from</span> <span class="string">&#x27;./index&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">// æ³¨å†Œæ¥å£</span></span><br><span class="line"> <span class="comment">// @parameter: &#123;username:username, phone:phone&#125; [object]</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">export</span> <span class="keyword">const</span> signUp = <span class="function"><span class="params">parameter</span> =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">return</span> post( <span class="comment">// è¯·æ±‚æ–¹æ³•</span></span><br><span class="line">    <span class="string">&#x27;signup/&#x27;</span>, <span class="comment">//è¯·æ±‚åœ°å€</span></span><br><span class="line">    parameter,</span><br><span class="line">  )</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

             
          </div>
        </div>
      <div class="post-footer">
        
    </div>
    
      <div class="recent-post-item">
          <div class="post-title ">
            <a href="/docker%E7%9A%84%E4%BD%BF%E7%94%A8/">dockerçš„åŸºæœ¬å‘½ä»¤åŠä½¿ç”¨</a>
          </div>
          <div class="post-meta">
            
            
              <div class="post-meta-item date">
                <span title="Created 2020.03.30"><i class="far fa-calendar-alt"></i> 2020.03.30</span>
              </div>
              <div class="post-meta-item updated">
                <span title="Updated 2021.04.02"><i class="far fa-calendar-check"></i> 2021.04.02</span>
              </div>
             
             
            
             <div class="post-meta-item wordcount">
                
                  <i class="fas fa-pencil-alt"></i> <span class="post-count">1.2k words</span>
                   
                
                  <i class="far fa-clock"></i> <span class="post-count">4 min</span>
                                       
              </div>
             
        </div>
          <div class="content">
            
                  <h1 id="docker"><a href="#docker" class="headerlink" title="docker"></a>docker</h1><p>ä¸€ï¼Œæ¦‚å¿µéƒ¨åˆ†ï¼š</p>
<ul>
<li>dockeræ˜¯ä»€ä¹ˆï¼Ÿ<ul>
<li>å…¶å®Dockeræ˜¯åŸºäº linux å†…æ ¸å®ç°ï¼ŒDocker æœ€æ—©é‡‡ç”¨ LXC æŠ€æœ¯ ï¼ŒLXC æ˜¯ Linux åŸç”Ÿæ”¯æŒçš„å®¹å™¨æŠ€æœ¯ï¼Œå¯ä»¥æä¾›è½»é‡çº§çš„è™šæ‹ŸåŒ– ï¼Œæœ€åˆæ˜¯ dotCloud å…¬å¸ï¼ˆåç”±äº Docker å¼€æºåå¤§å—æ¬¢è¿å°±å°†å…¬å¸æ”¹åä¸º Docker Inc ï¼Œæ€»éƒ¨ä½äºç¾å›½åŠ å·çš„æ—§é‡‘å±±ï¼‰å†…éƒ¨çš„ä¸€ä¸ªå¼€æºçš„ PAAS æœåŠ¡ (Platform as a ServiceService )çš„ä¸šä½™é¡¹ç›®ã€‚</li>
</ul>
</li>
<li>dockerçš„ä¼˜ç‚¹ï¼š<ul>
<li>  å¿«é€Ÿéƒ¨ç½²ï¼šçŸ­æ—¶é—´å†…å¯ä»¥éƒ¨ç½²æˆç™¾ä¸Šåƒä¸ªåº”ç”¨ï¼Œæ›´å¿«é€Ÿäº¤ä»˜åˆ°çº¿ä¸Š</li>
<li>  é«˜æ•ˆè™šæ‹ŸåŒ–ï¼šä¸éœ€è¦é¢å¤–hypervisoræ”¯æŒï¼ŒåŸºäºlinuxå†…æ ¸å®ç°åº”ç”¨è™šæ‹ŸåŒ–ï¼Œç›¸æ¯”è™šæ‹Ÿæœºå¤§å¹…æé«˜æ€§èƒ½å’Œæ•ˆç‡</li>
<li>  èŠ‚çœå¼€æ”¯ï¼šæé«˜æœåŠ¡å™¨åˆ©ç”¨ç‡ï¼Œé™ä½ITæ”¯å‡º</li>
<li>  ç®€åŒ–é…ç½®ï¼šå°†è¿è¡Œç¯å¢ƒæ‰“åŒ…ä¿å­˜è‡³å®¹å™¨ï¼Œä½¿ç”¨æ—¶ç›´æ¥å¯åŠ¨å³å¯</li>
<li>  ç¯å¢ƒç»Ÿä¸€ï¼šå°†å¼€å‘ï¼Œæµ‹è¯•ï¼Œç”Ÿäº§çš„åº”ç”¨è¿è¡Œç¯å¢ƒè¿›è¡Œæ ‡å‡†åŒ–å’Œç»Ÿä¸€ï¼Œå‡å°‘ç¯å¢ƒä¸ä¸€æ ·å¸¦æ¥çš„å„ç§é—®é¢˜</li>
<li>  å¿«é€Ÿè¿ç§»å’Œæ‰©å±•ï¼šå¯å®ç°è·¨å¹³å°è¿è¡Œåœ¨ç‰©ç†æœºã€è™šæ‹Ÿæœºã€å…¬æœ‰äº‘ç­‰ç¯å¢ƒï¼Œè‰¯å¥½çš„å…¼å®¹æ€§å¯ä»¥æ–¹ä¾¿å°†åº”ç”¨ä»Aå®¿ä¸»æœºè¿ç§»åˆ°Bå®¿ä¸»æœºï¼Œç”šè‡³æ˜¯Aå¹³å°è¿ç§»åˆ°Bå¹³å°</li>
</ul>
</li>
</ul>
<p>äºŒï¼Œåº”ç”¨åœºæ™¯ï¼š</p>
<ul>
<li>  èŠ‚çœé¡¹ç›®éƒ¨ç½²æ—¶é—´</li>
<li>  æ•´ä½“æ‰“åŒ…</li>
<li>  é…ç½®linuxç¯å¢ƒç­‰ç­‰</li>
</ul>
<p>ä¸‰ï¼ŒåŠŸèƒ½å®ç°</p>
<h3 id="é¦–å…ˆæ¥è¯´ä¸€ä¸‹dockerçš„é•œåƒçš„ä¸€äº›å¸¸ç”¨å‘½ä»¤"><a href="#é¦–å…ˆæ¥è¯´ä¸€ä¸‹dockerçš„é•œåƒçš„ä¸€äº›å¸¸ç”¨å‘½ä»¤" class="headerlink" title="é¦–å…ˆæ¥è¯´ä¸€ä¸‹dockerçš„é•œåƒçš„ä¸€äº›å¸¸ç”¨å‘½ä»¤"></a>é¦–å…ˆæ¥è¯´ä¸€ä¸‹dockerçš„é•œåƒçš„ä¸€äº›å¸¸ç”¨å‘½ä»¤</h3><ul>
<li>å®‰è£…docker  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum -y install docker</span><br></pre></td></tr></table></figure></li>
<li>æ‹‰å–é•œåƒ  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull é•œåƒå</span><br></pre></td></tr></table></figure></li>
<li>æŸ¥çœ‹æ‰€æœ‰é•œåƒ  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images</span><br></pre></td></tr></table></figure></li>
<li>åˆ é™¤é•œåƒ  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker rmi é•œåƒ<span class="built_in">id</span></span><br></pre></td></tr></table></figure></li>
<li>å¯åŠ¨æœåŠ¡  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service docker start</span><br></pre></td></tr></table></figure></li>
<li>æµ‹è¯•é•œåƒ  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker run é•œåƒid</span><br></pre></td></tr></table></figure>
<h3 id="ç„¶åå°±æ˜¯dockerå®¹å™¨"><a href="#ç„¶åå°±æ˜¯dockerå®¹å™¨" class="headerlink" title="ç„¶åå°±æ˜¯dockerå®¹å™¨"></a>ç„¶åå°±æ˜¯dockerå®¹å™¨</h3></li>
<li>æ‹‰å–é•œåƒ  <figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">$</span><span class="bash"> docker pull ubuntu</span></span><br></pre></td></tr></table></figure></li>
<li>å¯åŠ¨å®¹å™¨  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker run -it ubuntu /<span class="built_in">bin</span>/bash</span><br></pre></td></tr></table></figure>
<ul>
<li>-i: äº¤äº’å¼æ“ä½œã€‚</li>
<li>-t: ç»ˆç«¯ã€‚</li>
<li>ubuntu: ubuntu é•œåƒã€‚</li>
<li>/bin/bashï¼šæ”¾åœ¨é•œåƒååçš„æ˜¯å‘½ä»¤ï¼Œè¿™é‡Œæˆ‘ä»¬å¸Œæœ›æœ‰ä¸ªäº¤äº’å¼ Shellï¼Œå› æ­¤ç”¨çš„æ˜¯ /bin/bas</li>
</ul>
</li>
<li>æŸ¥çœ‹æ‰€æœ‰å®¹å™¨  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker ps -a</span><br></pre></td></tr></table></figure></li>
<li>åœæ­¢å®¹å™¨  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker stop å®¹å™¨<span class="built_in">id</span></span><br></pre></td></tr></table></figure></li>
<li>å¯åŠ¨å®¹å™¨  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ docker start å®¹å™¨<span class="built_in">id</span></span><br></pre></td></tr></table></figure></li>
<li>è¿›å…¥å®¹å™¨  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker attach å®¹å™¨<span class="built_in">id</span></span><br></pre></td></tr></table></figure></li>
<li>è¿™é‡Œæ¨èç”¨execçš„å› ä¸ºè¿™ä¸ªå®¹å™¨é€€å‡ºä¸ä¼šå¯¼è‡´å®¹å™¨åœæ­¢  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker <span class="built_in">exec</span> -it å®¹å™¨<span class="built_in">id</span> /<span class="built_in">bin</span>/bash</span><br></pre></td></tr></table></figure>
<h2 id="dockerfile"><a href="#dockerfile" class="headerlink" title="dockerfile"></a>dockerfile</h2></li>
</ul>
<ul>
<li>  æ¯ä¸€è¡Œä»¥Dockerfileçš„æŒ‡ä»¤å¼€å¤´ï¼ŒæŒ‡ä»¤ä¸åŒºåˆ†å¤§å°å†™ï¼Œä½†æ˜¯æƒ¯ä¾‹ä½¿ç”¨å¤§å†™</li>
<li>  ä½¿ç”¨ # å¼€å§‹ä½œä¸ºæ³¨é‡Š</li>
<li>  æ¯ä¸€è¡Œåªæ”¯æŒä¸€æ¡æŒ‡ä»¤ï¼Œæ¯æ¡æŒ‡ä»¤å¯ä»¥æºå¸¦å¤šä¸ªå‚æ•°</li>
<li>  æŒ‡ä»¤æŒ‰æ–‡ä»¶çš„é¡ºåºä»ä¸Š+</li>
<li>  è‡³ä¸‹è¿›è¡Œæ‰§è¡Œ</li>
<li>  æ¯ä¸ªæŒ‡ä»¤çš„æ‰§è¡Œä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„é•œåƒå±‚ï¼Œä¸ºäº†å‡å°‘åˆ†å±‚å’Œé•œåƒå¤§å°ï¼Œå°½å¯èƒ½å°†å¤šæ¡æŒ‡ä»¤åˆå¹¶æˆä¸€æ¡æŒ‡ä»¤</li>
<li>  åˆ¶ä½œé•œåƒä¸€èˆ¬å¯èƒ½éœ€è¦åå¤å¤šæ¬¡ï¼Œæ¯æ¬¡æ‰§è¡Œdockfileéƒ½æŒ‰é¡ºåºæ‰§è¡Œï¼Œä»å¤´å¼€å§‹ï¼Œå·²ç»æ‰§è¡Œè¿‡çš„æŒ‡ä»¤å·²ç»ç¼“å­˜ï¼Œä¸éœ€è¦å†æ‰§è¡Œï¼Œåç»­æœ‰ä¸€è¡ŒæŒ‡ä»¤æ²¡æ‰§è¡Œè¿‡ï¼Œå†å¾€åçš„æŒ‡ä»¤å°†ä¼šé‡æ–°æ‰§è¡Œï¼Œæ‰€ä»¥ä¸ºåŠ é€Ÿé•œåƒåˆ¶ä½œï¼Œå°†æœ€å¸¸å˜åŒ–çš„å†…å®¹æ”¾ä¸‹dockerfileçš„æ–‡ä»¶çš„åé¢</li>
</ul>
<h3 id="dockerfileçš„å¸¸ç”¨å‘½ä»¤"><a href="#dockerfileçš„å¸¸ç”¨å‘½ä»¤" class="headerlink" title="dockerfileçš„å¸¸ç”¨å‘½ä»¤"></a>dockerfileçš„å¸¸ç”¨å‘½ä»¤</h3><ul>
<li><p>å®šåˆ¶é•œåƒ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM nginx</span><br></pre></td></tr></table></figure></li>
<li><p>execå¯åŠ¨é•œåƒ</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RUN [<span class="string">&quot;å¯æ‰§è¡Œæ–‡ä»¶&quot;</span>, <span class="string">&quot;å‚æ•°1&quot;</span>, <span class="string">&quot;å‚æ•°2&quot;</span>]</span><br></pre></td></tr></table></figure></li>
<li><p>æ‹·è´æœ¬æœºæ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">COPY åŸè·¯å¾„ ç›®æ ‡è·¯å¾„</span><br></pre></td></tr></table></figure></li>
<li><p>ADD</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ADD ä¸ copy ç”¨æ³•ç±»ä¼¼ï¼Œå¯ä»¥è¯´ä»–æ¯”copyæ›´åŠ é«˜çº§</span><br><span class="line"></span><br><span class="line"><span class="comment"># ADD çš„ä¼˜ç‚¹ï¼šåœ¨æ‰§è¡Œ &lt;æºæ–‡ä»¶&gt; ä¸º tar å‹ç¼©æ–‡ä»¶çš„è¯ï¼Œå‹ç¼©æ ¼å¼ä¸º gzip, bzip2 ä»¥åŠ xz çš„æƒ…å†µä¸‹ï¼Œä¼šè‡ªåŠ¨å¤åˆ¶å¹¶è§£å‹åˆ° &lt;ç›®æ ‡è·¯å¾„&gt;ã€‚</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># ADD çš„ç¼ºç‚¹ï¼šåœ¨ä¸è§£å‹çš„å‰æä¸‹ï¼Œæ— æ³•å¤åˆ¶ tar å‹ç¼©æ–‡ä»¶ã€‚ä¼šä»¤é•œåƒæ„å»ºç¼“å­˜å¤±æ•ˆï¼Œä»è€Œå¯èƒ½ä¼šä»¤é•œåƒæ„å»ºå˜å¾—æ¯”è¾ƒç¼“æ…¢ã€‚å…·ä½“æ˜¯å¦ä½¿ç”¨ï¼Œå¯ä»¥æ ¹æ®æ˜¯å¦éœ€è¦è‡ªåŠ¨è§£å‹æ¥å†³å®šã€‚</span></span><br></pre></td></tr></table></figure></li>
<li><p>CMD æ¯ä¸ª Dockerfile åªèƒ½æœ‰ä¸€æ¡ CMD å‘½ä»¤ã€‚å¦‚æŒ‡å®šäº†å¤šæ¡ï¼Œåªæœ‰æœ€åä¸€æ¡è¢«æ‰§è¡Œ</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CMD [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</span><br><span class="line">CMD &lt;shell&gt;</span><br><span class="line">CMD [&quot;shell&quot;,&quot;args&quot;...]</span><br></pre></td></tr></table></figure></li>
<li><p>ENTRYPOINT</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä»–è·ŸCMDç±»ä¼¼ æ¯ä¸ª Dockerfile ä¸­åªèƒ½æœ‰ä¸€ä¸ª ENTRYPOINTï¼Œå½“æŒ‡å®šå¤šä¸ªæ—¶ï¼Œåªæœ‰æœ€åä¸€ä¸ªç”Ÿæ•ˆ</span></span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">EXTRYPOINT [&quot;executable&quot;, &quot;param1&quot;, &quot;param2&quot;]</span><br></pre></td></tr></table></figure></li>
<li><p>ENV</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æŒ‡å®šä¸€ä¸ªç¯å¢ƒå˜é‡ï¼Œä¼šè¢«åç»­ RUN æŒ‡ä»¤ä½¿ç”¨ï¼Œå¹¶åœ¨å®¹å™¨è¿è¡Œæ—¶ä¿æŒ</span></span><br><span class="line">ENV &lt;key&gt; &lt;value&gt;</span><br></pre></td></tr></table></figure></li>
<li><p>EXPOSE</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å£°æ˜ç«¯å£å¸®åŠ©é•œåƒä½¿ç”¨è€…ç†è§£è¿™ä¸ªé•œåƒæœåŠ¡çš„å®ˆæŠ¤ç«¯å£ï¼Œä»¥æ–¹ä¾¿é…ç½®æ˜ å°„</span></span><br><span class="line">EXPOSE &lt;ç«¯å£<span class="number">1</span>&gt; [&lt;ç«¯å£<span class="number">2</span>&gt;...]</span><br></pre></td></tr></table></figure></li>
<li><p>WORKDIR</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ä¸ºåç»­çš„ RUNã€CMDã€ENTRYPOINT æŒ‡ä»¤é…ç½®å·¥ä½œç›®å½•ï¼Œå½“å®¹å™¨è¿è¡Œåï¼Œè¿›å…¥å®¹å™¨å†…çš„é»˜è®¤ç›®å½•</span></span><br><span class="line">WORKDIR /path</span><br></pre></td></tr></table></figure></li>
</ul>

             
          </div>
        </div>
      <div class="post-footer">
        
    </div>
    
      <div class="recent-post-item">
          <div class="post-title ">
            <a href="/%E5%BE%AE%E5%8D%9A%E4%B8%89%E6%96%B9%E7%99%BB%E5%BD%95/">å¾®åšä¸‰æ–¹ç™»å½•</a>
          </div>
          <div class="post-meta">
            
            
              <div class="post-meta-item date">
                <span title="Created 2019.08.30"><i class="far fa-calendar-alt"></i> 2019.08.30</span>
              </div>
              <div class="post-meta-item updated">
                <span title="Updated 2021.04.02"><i class="far fa-calendar-check"></i> 2021.04.02</span>
              </div>
             
             
            
             <div class="post-meta-item wordcount">
                
                  <i class="fas fa-pencil-alt"></i> <span class="post-count">1.1k words</span>
                   
                
                  <i class="far fa-clock"></i> <span class="post-count">4 min</span>
                                       
              </div>
             
        </div>
          <div class="content">
            
                  <h1 id="å¾®åšä¸‰æ–¹ç™»å½•"><a href="#å¾®åšä¸‰æ–¹ç™»å½•" class="headerlink" title="å¾®åšä¸‰æ–¹ç™»å½•"></a>å¾®åšä¸‰æ–¹ç™»å½•</h1><h3 id="ä¸€-å¾®åšä¸‰æ–¹ç™»å½•ç‰¹ç‚¹"><a href="#ä¸€-å¾®åšä¸‰æ–¹ç™»å½•ç‰¹ç‚¹" class="headerlink" title="ä¸€,å¾®åšä¸‰æ–¹ç™»å½•ç‰¹ç‚¹:"></a>ä¸€,å¾®åšä¸‰æ–¹ç™»å½•ç‰¹ç‚¹:</h3><ul>
<li>  å¾®åšç™»å½•åŒ…æ‹¬èº«ä»½è®¤è¯ã€ç”¨æˆ·å…³ç³»ä»¥åŠå†…å®¹ä¼ æ’­ã€‚å…è®¸ç”¨æˆ·ä½¿ç”¨å¾®åšå¸å·ç™»å½•è®¿é—®ç¬¬ä¸‰æ–¹ç½‘ç«™ï¼Œåˆ†äº«å†…å®¹ï¼ŒåŒæ­¥ä¿¡æ¯ã€‚å®ƒæœ‰å¦‚ä¸‹ç‰¹ç‚¹ï¼š</li>
<li>ç›´æ¥ç”¨å¾®åšè´¦å·ç™»å½•ä½ çš„åº”ç”¨æˆ–ç½‘ç«™ï¼›</li>
<li>è·å¾—é«˜è´¨é‡å¾®åšæ´»è·ƒç”¨æˆ·ï¼›</li>
<li>æ›´ä¾¿æ·çš„åˆ†äº«åˆ°å¾®åšï¼Œæé«˜ç½‘ç«™ä¿¡æ¯ä¼ æ’­åŠ›ï¼›<h3 id="äºŒ-åº”ç”¨åœºæ™¯"><a href="#äºŒ-åº”ç”¨åœºæ™¯" class="headerlink" title="äºŒ,åº”ç”¨åœºæ™¯:"></a>äºŒ,åº”ç”¨åœºæ™¯:</h3></li>
<li>å¯ä»¥é¿å…å¤æ‚ç¹ççš„æ³¨å†Œæµç¨‹,è®©ç”¨æˆ·ç”¨è‡ªå·±å·²æœ‰çš„ä¸‰æ–¹è´¦å·å»ç™»é™†<h3 id="ä¸‰-åŠŸèƒ½å®ç°"><a href="#ä¸‰-åŠŸèƒ½å®ç°" class="headerlink" title="ä¸‰,.åŠŸèƒ½å®ç°"></a>ä¸‰,.åŠŸèƒ½å®ç°</h3></li>
<li>é¦–å…ˆè¿›å…¥å¾®åšå¼€æ”¾å¹³å° <a target="_blank" rel="noopener" href="https://open.weibo.com/">https://open.weibo.com/</a> æ³¨å†Œä¸€ä¸ªåº”ç”¨(ä¸ªäºº,ä¼ä¸š),å¡«å†™åº”ç”¨ä¿¡æ¯åŠå›è°ƒåœ°å€</li>
<li>ä½¿ç”¨æ–°æµªå¾®åšçš„å¼€æ”¾APIï¼Œå°±éœ€è¦è·Ÿæ–°æµªç”³è¯·ä¸€ä¸ªappkeyå’ŒApp Secretï¼Œè¿™ä¸¤ä¸ªç§˜é’¥éœ€è¦ä½ çš„åº”ç”¨å®¡æ ¸é€šè¿‡,å®˜æ–¹æ‰ä¼šç»™å‡º</li>
<li>å‚æ•°ä¼ é€’</li>
</ul>
<p>| | å¿…é€‰ | ç±»å‹åŠèŒƒå›´ | è¯´æ˜ |<br>|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|<br>| client_id | true | string | ç”³è¯·åº”ç”¨æ—¶åˆ†é…çš„AppKey |<br>| redirect_uri | true | string |æˆæƒå›è°ƒåœ°å€ï¼Œç«™å¤–åº”ç”¨éœ€ä¸è®¾ç½®çš„å›è°ƒåœ°å€ä¸€è‡´ï¼Œç«™å†…åº”ç”¨éœ€å¡«å†™canvas pageçš„åœ°å€ |<br>scope | false|string |ç”³è¯·scopeæƒé™æ‰€éœ€å‚æ•°ï¼Œå¯ä¸€æ¬¡ç”³è¯·å¤šä¸ªscopeæƒé™ï¼Œç”¨é€—å·åˆ†éš”ã€‚ä½¿ç”¨æ–‡æ¡£<br>| state |false | string | ç”¨äºä¿æŒè¯·æ±‚å’Œå›è°ƒçš„çŠ¶æ€ï¼Œåœ¨å›è°ƒæ—¶ï¼Œä¼šåœ¨Query Parameterä¸­å›ä¼ è¯¥å‚æ•°ã€‚å¼€å‘è€…å¯ä»¥ç”¨è¿™ä¸ªå‚æ•°éªŒè¯è¯·æ±‚æœ‰æ•ˆæ€§ï¼Œä¹Ÿå¯ä»¥è®°å½•ç”¨æˆ·è¯·æ±‚æˆæƒé¡µå‰çš„ä½ç½®ã€‚è¿™ä¸ªå‚æ•°å¯ç”¨äºé˜²æ­¢è·¨ç«™è¯·æ±‚ä¼ªé€ ï¼ˆCSRFï¼‰æ”»å‡»|<br>| display | false | string | æˆæƒé¡µé¢çš„ç»ˆç«¯ç±»å‹ï¼Œå–å€¼è§ä¸‹é¢çš„è¯´æ˜ |<br>forcelogin    false    boolean    æ˜¯å¦å¼ºåˆ¶ç”¨æˆ·é‡æ–°ç™»å½•ï¼Œtrueï¼šæ˜¯ï¼Œfalseï¼šå¦ã€‚é»˜è®¤false|<br>| language | false | string | æˆæƒé¡µè¯­è¨€ï¼Œç¼ºçœä¸ºä¸­æ–‡ç®€ä½“ç‰ˆï¼Œenä¸ºè‹±æ–‡ç‰ˆã€‚è‹±æ–‡ç‰ˆæµ‹è¯•ä¸­ï¼Œå¼€å‘è€…ä»»ä½•æ„è§å¯åé¦ˆè‡³ @å¾®åšAPI|</p>
<p>displayè¯´æ˜ï¼š<br>| å‚æ•°å–å€¼ | ç±»å‹è¯´æ˜ |<br>|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|<br>| default | é»˜è®¤çš„æˆæƒé¡µé¢ï¼Œé€‚ç”¨äºwebæµè§ˆå™¨ |<br>| mobile | ç§»åŠ¨ç»ˆç«¯çš„æˆæƒé¡µé¢ï¼Œé€‚ç”¨äºæ”¯æŒhtml5çš„æ‰‹æœºã€‚æ³¨ï¼šä½¿ç”¨æ­¤ç‰ˆæˆæƒé¡µè¯·ç”¨<a target="_blank" rel="noopener" href="https://open.weibo.cn/oauth2/authorize">https://open.weibo.cn/oauth2/authorize</a> æˆæƒæ¥å£|<br>| wap    | wapç‰ˆæˆæƒé¡µé¢ï¼Œé€‚ç”¨äºéæ™ºèƒ½æ‰‹æœº |<br>| client | å®¢æˆ·ç«¯ç‰ˆæœ¬æˆæƒé¡µé¢ï¼Œé€‚ç”¨äºPCæ¡Œé¢åº”ç”¨ |<br>| apponweibo | é»˜è®¤çš„ç«™å†…åº”ç”¨æˆæƒé¡µï¼Œæˆæƒåä¸è¿”å›access_tokenï¼Œåªåˆ·æ–°ç«™å†…åº”ç”¨çˆ¶æ¡†æ¶ã€‚|</p>
<p>| è¿”å›å€¼å­—æ®µ | å­—æ®µç±»å‹ |å­—æ®µè¯´æ˜|<br>|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|:â€”â€“|<br>| code | string | ç”¨äºç¬¬äºŒæ­¥è°ƒç”¨oauth2/access_tokenæ¥å£ï¼Œè·å–æˆæƒåçš„access tokenã€‚|<br>| state | string | å¦‚æœä¼ é€’å‚æ•°ï¼Œä¼šå›ä¼ è¯¥å‚æ•°| </p>
<ul>
<li>å»åç«¯settingsé‡Œé…ç½®ç§˜é’¥åŠä¿¡æ¯<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># é…ç½® å¾®åš ä¸‰æ–¹ç™»å½•çš„ åº”ç”¨ä¿¡æ¯</span></span><br><span class="line">WEIBO_App_Key = <span class="string">&quot;&quot;</span></span><br><span class="line">WEIBO_App_Secret = <span class="string">&quot;&quot;</span></span><br><span class="line">WEIBO_URL = <span class="string">&quot;&quot;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¼€å‘ä¸€ä¸ª è·å–å¾®åš è®¤è¯é¡µæ¥å£</span></span><br><span class="line"><span class="comment"># å¯¼å…¥ä½ åœ¨settingsé‡Œé…ç½®çš„ä¿¡æ¯</span></span><br><span class="line"><span class="keyword">from</span> <span class="number">2004</span>(è¿™ä¸ªåœ°æ–¹æ˜¯ä½ è‡ªå·±çš„é¡¹ç›®åç§°).settings <span class="keyword">import</span> WEIBO_App_Key, WEIBO_URL, WEIBO_App_Secret</span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> urlencode</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">WeiboUrlView</span>(<span class="params">APIView</span>):</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">get</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        weibo_url_base = <span class="string">&quot;https://api.weibo.com/oauth2/authorize?&quot;</span></span><br><span class="line"></span><br><span class="line">        params = &#123;</span><br><span class="line">            <span class="string">&quot;client_id&quot;</span>: WEIBO_App_Key,</span><br><span class="line">            <span class="string">&quot;redirect_uri&quot;</span>: WEIBO_URL,</span><br><span class="line">        &#125;</span><br><span class="line">        weibo_url = weibo_url_base + urlencode(params)</span><br><span class="line">        <span class="keyword">return</span> Response(&#123;<span class="string">&quot;url&quot;</span>: weibo_url&#125;)</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">post</span>(<span class="params">self, request</span>):</span></span><br><span class="line">        <span class="comment">#  è·å–åˆ°codeï¼Œç„¶å å» è®¿é—®token</span></span><br><span class="line">        code = request.data.get(<span class="string">&quot;code&quot;</span>)</span><br><span class="line"></span><br><span class="line">        r = requests.post(<span class="string">&quot;https://api.weibo.com/oauth2/access_token&quot;</span>, &#123;</span><br><span class="line">            <span class="string">&quot;client_id&quot;</span>: WEIBO_App_Key,</span><br><span class="line">            <span class="string">&quot;client_secret&quot;</span>: WEIBO_App_Secret,</span><br><span class="line">            <span class="string">&quot;grant_type&quot;</span>: <span class="string">&quot;authorization_code&quot;</span>,</span><br><span class="line">            <span class="string">&quot;code&quot;</span>: code,</span><br><span class="line">            <span class="string">&quot;redirect_uri&quot;</span>: WEIBO_URL</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è·å– è¿”å›çš„å¯¹è±¡</span></span><br><span class="line">        <span class="built_in">print</span>(r.json())</span><br><span class="line">        access_token = r.json()[<span class="string">&quot;access_token&quot;</span>]</span><br><span class="line">        uid = r.json()[<span class="string">&quot;uid&quot;</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># è¿›è¡Œ ä¸‰æ–¹ç”¨æˆ·çš„ æ³¨å†Œæ“ä½œï¼Œ</span></span><br><span class="line">        <span class="comment"># é¦–å…ˆåˆ¤æ–­ ç”¨æˆ·æœ‰æ²¡æœ‰ ä¹‹å‰ ç™»å½•è¿‡ï¼Œå¦‚æœç™»å½•è¿‡å‘¢ åˆ™ ä¸æ³¨å†Œï¼Œå¦‚æœæ²¡æœ‰ç™»å½•è¿‡ åˆ™æ³¨å†Œ</span></span><br><span class="line">        openUser = OpenUser.objects.<span class="built_in">filter</span>(uid=<span class="string">&quot;wb&quot;</span> + uid).first()</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> openUser <span class="keyword">or</span> <span class="keyword">not</span> openUser.user:</span><br><span class="line">            <span class="comment"># ä¸å­˜åœ¨ï¼Œåˆ™æ³¨å†Œ</span></span><br><span class="line">            openUser = OpenUser.objects.create(uid=<span class="string">&quot;wb&quot;</span> + uid, <span class="built_in">type</span>=<span class="string">&quot;å¾®åš&quot;</span>)</span><br><span class="line">            <span class="keyword">return</span> Response(&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;è¿˜æ²¡æœ‰ç»‘å®šæœ¬åœ°è´¦å·&quot;</span>, <span class="string">&quot;uid&quot;</span>: openUser.uid, <span class="string">&quot;code&quot;</span>: <span class="number">400</span>&#125;)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="comment"># æœ‰è¿™ä¸ªæœˆçš„ä¸‰æ–¹è´¦å·ï¼Œä¸”å·²ç»ç»‘å®šæˆåŠŸ, éœ€è¦è¿”å›ä»¤ç‰Œ</span></span><br><span class="line">            <span class="comment"># åˆ¤æ–­</span></span><br><span class="line">            user = openUser.user</span><br><span class="line">            <span class="keyword">if</span> user:</span><br><span class="line">                payload = &#123;</span><br><span class="line">                    <span class="string">&quot;uid&quot;</span>: user.<span class="built_in">id</span>,</span><br><span class="line">                    <span class="string">&#x27;exp&#x27;</span>: datetime.datetime.utcnow() + datetime.timedelta(hours=<span class="number">2</span>),</span><br><span class="line">                &#125;</span><br><span class="line">                token = jwt.encode(payload, SECRET_KEY)</span><br><span class="line">                <span class="keyword">return</span> Response(&#123;<span class="string">&quot;msg&quot;</span>: <span class="string">&quot;ç™»å½•æˆåŠŸ&quot;</span>, <span class="string">&quot;token&quot;</span>: token, <span class="string">&quot;code&quot;</span>: <span class="number">200</span>, <span class="string">&quot;username&quot;</span>: user.username&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment"># å›è°ƒåœ°å€</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">weibo_callback</span>(<span class="params">request</span>):</span></span><br><span class="line">    code = request.GET.get(<span class="string">&quot;code&quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> redirect(<span class="string">&quot;http://127.0.0.1:8080/#/oauth?code=&quot;</span> + code)</span><br><span class="line"></span><br></pre></td></tr></table></figure>
             
          </div>
        </div>
      <div class="post-footer">
        
    </div>
    
  </div>



<nav class="paginator">
      
            <a class="prev" href="/">< Prev</a>
            
            
</nav>

    
<a id="gotop" href="javascript:" title="è¿”å›é¡¶éƒ¨"><i class="fa fa-arrow-up"></i></a>
    






    
<div id="bottom-outer">
    <div id="bottom-inner">
        Â© 2020 <i class="fa fa-heart" id="heart"></i> é˜¿æ­£ 
        <br>
        Powered by 
        <a target="_blank" rel="noopener" href="http://hexo.io">hexo</a> | Theme is <a target="_blank" rel="noopener" href="https://github.com/a2396837/hexo-theme-blank/">blank</a>
        
          <div class="icp-info">
            
          <a href="" target="_blank"> </a>
        </div>
        
    </div>  
  </div>
  
<script src="https://cdn.jsdelivr.net/npm/layui-src@2.5.5/dist/layui.min.js"></script>



  
    <script src="/js/script.js"></script>
  
    <script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script>
  

 



  <script>
    window.lazyLoadOptions = {
      elements_selector: 'img',
      threshold: 0
    }
</script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script>   
  


  <script>
    var images = $('img').not('.nav-logo img').not('.card img').not($('a>img')).not('.reward-content img')
    images.each(function (i, o) {
      var lazyloadSrc = $(o).attr('data-src') ? $(o).attr('data-src') : $(o).attr('src')
      $(o).wrap(`<a href="${lazyloadSrc}" data-fancybox="group" data-caption="${$(o).attr('alt')}" class="fancybox"></a>`)
    })
  </script>
  <script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script>
  <script>
        $().fancybox({
      selector: '[data-fancybox]',
      loop: true,
      transitionEffect: 'slide',
      protect: true,
      buttons: ['slideShow', 'fullScreen', 'thumbs', 'close']
    })
  </script>   
  


  <script>
  if (!window.MathJax) {
    window.MathJax = {
      loader: {
        source: {
          '[tex]/amsCd': '[tex]/amscd'
        }
      },
      tex: {
        inlineMath: [ ['$','$'], ["\\(","\\)"]],
        tags: 'ams'
      },
      options: {
        renderActions: {
          findScript: [10, doc => {
            for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
              const display = !!node.type.match(/; *mode=display/)
              const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
              const text = document.createTextNode('')
              node.parentNode.replaceChild(text, node)
              math.start = {node: text, delim: '', n: 0}
              math.end = {node: text, delim: '', n: 0}
              doc.math.push(math)
            }
          }, '']
        }
      }
    }
    
    var script = document.createElement('script')
    script.src = "https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"
    script.id = 'MathJax-script'
    script.async = true
    document.head.appendChild(script)
  } else {
    MathJax.startup.document.state(0)
    MathJax.texReset()
    MathJax.typeset()
  }
  </script>
  


  
<script>
if (document.getElementsByClassName('mermaid').length) {
    if (window.mermaidJsLoad) mermaid.init()
    else {
      $.getScript("https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js", function () {
        window.mermaidJsLoad = true
        mermaid.initialize({
          theme: "default",
        })
      })
    }
  }
  </script>
  




  
<div id="QPlayer">
	<div id="pContent">
		<div id="player">
			<span class="cover"></span>
			<div class="ctrl">
				<div class="musicTag marquee">
					<strong>Title</strong>
					 <span> - </span>
					<span class="artist">Artist</span>
				</div>
				<div class="progress">
					<div class="timer left">0:00</div>
					<div class="contr">
						<div class="rewind icon"></div>
						<div class="playback icon"></div>
						<div class="fastforward icon"></div>
					</div>
					<div class="right">
						<div class="liebiao icon"></div>
					</div>
				</div>
			</div>
		</div>
		<div class="ssBtn">
				<div class="adf"><i class="fas fa-music" style="color: #Fff;"></i></div>
		</div>
	</div>
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/css/audio.css">
	<ol id="playlist"></ol>
</div>
<script src="https://cdn.jsdelivr.net/npm/jquery.marquee@1.5.0/jquery.marquee.min.js"></script>
<script>
	var playlist = [];
	
	var isRotate = true;
	var autoplay = false;
  </script>
<script src="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/js/player.js"></script>
<script>
  function bgChange(){
	var lis= $('.lib');
	for(var i=0; i<lis.length; i+=2)
	lis[i].style.background = 'rgba(246, 246, 246, 0.5)';
  }
  window.onload = bgChange;
</script>

  


  <script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script>
  


  <script src="https://cdn.jsdelivr.net/gh/a2396837/CDN@latest/js/firework.js"></script>
  


  
<script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js"></script>
<script>
!function (e, t, a) {
  var initCopyCode = function(){
    var copyHtml = '';
    copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
    copyHtml += '  <i class="fa fa-clipboard"></i><span>å¤åˆ¶</span>';
    copyHtml += '</button>';
    $(".highlight .code pre").before(copyHtml);
    new ClipboardJS('.btn-copy', {
      target: function(trigger) {
        return trigger.nextElementSibling;
      }
    });
  }
  initCopyCode();
}(window, document);
</script>  
  

<script>
  var btntop = $('#gotop');
  btntop.on('click', function (e) {
    e.preventDefault();
    $('html, body').animate({ scrollTop: 0 }, '300');
  });

  var $table = $('.content table').not($('figure.highlight > table'))
$table.each(function () {
  $(this).wrap('<div class="table-wrap"></div>')
})
</script>



</html>